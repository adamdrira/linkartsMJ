

<div class="logo-container" *ngIf="!show_sent_mail">
    <img src="../../assets/img/svg/Logo-LA3.svg">
</div>

<img  src="../../assets/img/tuto-logos/tuto-palette.svg"  class="invisible-height">
<img  src="../../assets/img/tuto-logos/tuto-books.svg" class="invisible-height">
<img  src="../../assets/img/tuto-logos/win.svg"  class="invisible-height">

<button class="close-button" (click)="close_dialog()">
    <mat-icon [ngClass]="{'invisible': !show_icon }">close</mat-icon>
</button>



<div class="popup-signup" *ngIf="!for_group_creation">

    
    <ng-container *ngIf="step==0 && !show_sent_mail">

        <div class="step-name">
            <span>Bienvenue sur LinkArts ! </span>
        </div>

        

        <div class="step-form" [formGroup]="registerForm1">




            <div class="form-item">
                <mat-form-field floatLabel='never' class="select-class">
                    <mat-label>Type de compte*</mat-label>
                    <mat-select [compareWith]="compareObjects" disableOptionCentering formControlName="type_of_account" panelClass="signupSelectClass options-with-description">
                        <mat-select-trigger>
                            {{registerForm1.value?.type_of_account}}
                        </mat-select-trigger>
                        
                        <div *ngFor="let obj of listOfAccounts; let i = index">
                            <mat-option [value]="obj">
                                {{ obj }}
                                <div class="text-container">
                                    <img  [src]="listOfAccountsImages[i]" >
                                    <span >{{listOfAccountsDescriptions[i]}}</span>
                                </div>
                                
                            </mat-option>
                        </div>
                    </mat-select>
                    <mat-error *ngIf="registerForm1.controls['type_of_account'].invalid">Veuillez sélectionner un type de compte</mat-error>
                </mat-form-field>
            </div>

            <div class="form-item">
                <mat-form-field floatLabel='never'>
                    <mat-label >Nom complet*</mat-label>
                    <input matInput formControlName="firstName" maxLength="40" type="search" autocomplete="off" (input)="normalize_input(registerForm1, 'firstName');">
                    <mat-error *ngIf="registerForm1.controls['firstName'].invalid">Saisie invalide : les espaces en début de saisie ainsi que les caractères spéciaux ne sont pas autorisés
                    </mat-error>
                    <div class="length-indicator">{{registerForm1.controls['firstName'].value?.length || 0}}/40</div>
                </mat-form-field>
            </div>

            <div class="form-item">
                <mat-form-field floatLabel='never'>
                    <mat-label>Pseudonyme*</mat-label>
                    <input matInput formControlName="nickname" maxLength="30" type="search" autocomplete="off" (input)="normalize_input(registerForm1, 'nickname');check_pseudo()">
                    <mat-error *ngIf="registerForm1.controls['nickname'].invalid">Saisie invalide. Caractères autorisés : chiffres, lettres, ".", "'", "’", "&", "_", "-" 
                    </mat-error>
                    <div class="length-indicator">{{registerForm1.controls['nickname'].value?.length || 0}}/30</div>
                </mat-form-field>
            </div>
            
            <div class="form-item">
                <mat-form-field floatLabel='never'>
                    <mat-label>E-mail*</mat-label>
                    <input matInput formControlName="email" autocomplete="off" type="search" (input)="normalize_input(registerForm1, 'email');check_email();">
                    <mat-error *ngIf="registerForm1.controls['email'].invalid">Veuillez saisir un e-mail valide
                    </mat-error>
                </mat-form-field>
            </div>
            
            <div class="form-item">
                <mat-form-field floatLabel='never'>
                    <mat-label>Mot de passe*</mat-label>
                    <input matInput formControlName="password" [type]="hide ? 'password' : 'text'" autocomplete="off" (input)="normalize_input(registerForm1, 'password')">
                    <mat-error *ngIf="registerForm1.controls['password'].invalid">Minimum : 8 caractères, une minuscule, une majuscule et un chiffre
                    </mat-error>

                    <div class="remove-red-eye" (click)="change_password_type()"
                    [matTooltip]="hide ? 'Voir le mot de passe' : 'Cacher le mot de passe'"
                    matTooltipClass='linkarts-tooltip'
                    [matTooltipPosition]="'below'"
                    [matTooltipShowDelay]="100">
                        <mat-icon [ngClass]="{'invisible': !show_icon }" *ngIf="hide" [@enterAnimation]>visibility</mat-icon>
                        <mat-icon [ngClass]="{'invisible': !show_icon }" *ngIf="!hide" [@enterAnimation]>visibility_off</mat-icon>
                    </div>
                </mat-form-field>
            </div>
        </div>

       
        <div class="form-item height-unset">
            <div class="cgu-container">
                <mat-slide-toggle [checked]="cgu_accepted" (change)="setCgu( $event )" style="font-weight:bold;">
                    J'accepte les conditions d'utilisation
                </mat-slide-toggle>
                <span (click)="read_conditions();" class="read_conditions">(lire les conditions)</span>
            </div>
        </div>

        <button class="submit-button"  (click)="validate_step(0);">
            <span *ngIf="!loading_signup">M'inscrire</span>
            <div class="loading-dots" *ngIf="loading_signup">
                &nbsp; <span>.</span><span>.</span><span>.</span>
            </div>
        </button>
  

        <div class="error">
            <span *ngIf="display_need_information" [@enterAnimation]>Veuillez remplir les champs obligatoires.</span>
            <span *ngIf="!display_need_information && !display_pseudo_found_1 && display_email_and_password_error && validate_clicked" [@enterAnimation]>Oups ! Un compte similaire existe déjà.</span>         
            <span *ngIf="!display_need_information && !display_email_and_password_error && display_pseudo_found_1" [@enterAnimation]>Attention ce pseudonyme est déjà utilisé.</span>
            <span *ngIf="!display_need_information && !display_email_and_password_error && !display_pseudo_found_1 && display_cgu_error && validate_clicked" [@enterAnimation]>Veuillez accepter les conditions d'utilisation</span>
        </div>

    </ng-container>


    
    <ng-container *ngIf="step==1 && !show_sent_mail">

        <div class="message-container"  [@enterFromRightAnimation]>
            <div class="left-container" [ngClass]="{'shiny': !pp_is_loaded}">
                <img [src]="profile_picture" (load)="load_pp()" [ngClass]="{'invisible': !pp_is_loaded}">
            </div>
            <div class="right-container">
                <div class="title">
                    Adam de LinkArts
                </div>
                <div class="text">
                    <span *ngIf="show_text && registerForm1.value.type_of_account=='Artiste'">C'est noté {{registerForm1.value.firstName}} ! pourriez-vous nous parler un peu plus de vous ?</span>
                    <span *ngIf="show_text && registerForm1.value.type_of_account!='Artiste'">C'est noté {{registerForm1.value.firstName}} ! pourriez-vous nous parler un peu de votre société ?</span>
                    <div class="loading-dots" *ngIf="!show_text">
                        &nbsp; <span>.</span><span>.</span><span>.</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="step-form" [formGroup]="registerForm2"  [@enterFromRightAnimation]>


            <div class="form-item" *ngIf="registerForm1.value.type_of_account!='Artiste'">
                <mat-form-field floatLabel='never'>
                    <mat-label >Nom de la société représentée*</mat-label>
                    <input matInput formControlName="SocietyName" maxLength="40" type="search" autocomplete="off" (input)="normalize_input(registerForm2, 'SocietyName');">
                    <mat-error *ngIf="registerForm2.controls['SocietyName'].invalid">Saisie invalide : les espaces en début de saisie ainsi que les caractères spéciaux ne sont pas autorisés
                    </mat-error>
                    <div class="length-indicator">{{registerForm2.controls['SocietyName'].value?.length || 0}}/40</div>
                </mat-form-field>
            </div>

            <div class="form-item" *ngIf="registerForm1.value.type_of_account!='Artiste'">
                <mat-form-field floatLabel='never'>
                    <mat-label>Numéro SIREN de la société représentée</mat-label>
                    <input matInput formControlName="siret" autocomplete="off" maxLength="9" type="search" (input)="normalize_input(registerForm2, 'siret');">
                    <mat-error *ngIf="registerForm2.controls['siret'].invalid">Veuillez saisir un numéro SIREN valide (9 chiffres)
                    </mat-error>
                    <div class="length-indicator">{{registerForm2.controls['siret'].value?.length || 0}}/9</div>
                </mat-form-field>
            </div>

          
           
            <div class="form-item" style="height:unset !important; margin-bottom: 15px;"  *ngIf="registerForm1.value.type_of_account=='Artiste'">
                <mat-form-field floatLabel='never'>
                    <mat-label> Quel type d'artiste êtes-vous ? <br> E.g. Je suis un scénariste de bandes dessinées.</mat-label>
                    <textarea matInput cdkTextareaAutosize formControlName="primary_description" maxLength="100" autocomplete="off" (input)="normalize_input(registerForm2, 'primary_description');"></textarea>
                   <mat-error *ngIf="registerForm2.controls['primary_description'].invalid">Saisie invalide : les espaces en début de saisie ainsi que certains caractères spéciaux ne sont pas autorisés
                    </mat-error>
                    <div class="length-indicator">{{registerForm2.controls['primary_description'].value?.length || 0}}/100</div>
                </mat-form-field>
            </div>

            <div class="form-item" style="margin-bottom: 15px;">
                <mat-form-field floatLabel='never' class="select-class">
                    <mat-label>Pays</mat-label>
                    <mat-select [(value)]="selected_country" placeholder="Mode" (selectionChange)="adding_country()"  disableOptionCentering formControlName="country" panelClass="signupSelectCountryClass">
                        <mat-option  *ngFor="let obj of list_of_countries" [value]="obj">
                            {{ obj }}
                        </mat-option>
                    </mat-select>
                    <mat-error *ngIf="registerForm2.controls['country'].invalid ">Veuillez selectionner un pays</mat-error>
                </mat-form-field>
            </div>

            <div class="form-item" style="margin-bottom: 15px;">
                <mat-form-field floatLabel='never'>
                    <mat-label>Ville</mat-label>
                    <input matInput formControlName="city" (input)="normalize_input(registerForm2, 'city');adding_city();" autocomplete="off" maxLength="30" type="search">
                    <mat-error *ngIf="registerForm2.controls['city'].invalid ">Saisie invalide : les espaces en début de saisie ainsi que certains caractères spéciaux ne sont pas autorisés
                    </mat-error>
                    <div class="length-indicator">{{registerForm2.controls['city'].value?.length || 0}}/30</div>
                </mat-form-field>
            </div>

            <div class="form-item" *ngIf="registerForm1.value.type_of_account=='Artiste'">
                <mat-form-field floatLabel='never'>
                    <mat-label>Date de naissance (jj/mm/aaaa)</mat-label>
                    <input matInput [matDatepicker]="picker" [max]="maxDate" formControlName="birthday">
                    <mat-datepicker-toggle matSuffix [for]="picker">
                        <mat-icon [ngClass]="{'invisible': !show_icon }" matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
                    </mat-datepicker-toggle>
                    <mat-error *ngIf="registerForm2.controls['birthday'].invalid">Veuillez saisir une date de naissance valide</mat-error>
                    <mat-datepicker #picker disabled="false" panelClass="signup-datepicker" startView="multi-year"></mat-datepicker>
                </mat-form-field>
            </div>
        </div>


        <button class="submit-button" (click)="validate_step(1);">
            <span *ngIf="!loading_signup">Terminer</span>
            <div class="loading-dots" *ngIf="loading_signup">
                &nbsp; <span>.</span><span>.</span><span>.</span>
            </div>
        </button>


    </ng-container>



    <div *ngIf="show_sent_mail" [@enterFromTopAnimation]>
        <div class="sent-mail-icon" >
            <mat-icon [ngClass]="{'invisible': !show_icon }">mail_outline</mat-icon>
        </div>
        <div class="sent-mail-text" >
            <span>Merci pour votre inscription ! <br> Un lien permettant de vérifier votre adresse e-mail a été envoyé à l'adresse suivante :</span>
            <span>{{registerForm1.value.email.toLowerCase()}}</span>
        </div>

        <button class="finish-button" (click)="finish();">
            <span>Se connecter</span>
        </button>
    </div>

</div>

